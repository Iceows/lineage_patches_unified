From 8de24edd26b3701b32281a83a6260e6518b7a252 Mon Sep 17 00:00:00 2001
From: Raphael Mounier <mounierr07@gmail.com>
Date: Wed, 26 Jan 2022 18:20:08 +0100
Subject: [PATCH] Fix storage permission for a-only device with media apps

Fixes storage permission for some devices (mainly with Oreo vendor, A-only) access for media files from some apps like WhatsApp , Telegram or Instagram
---
 data/etc/platform.xml | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/data/etc/platform.xml b/data/etc/platform.xml
index cf312165dd9a..48daf8f5faf3 100644
--- a/data/etc/platform.xml
+++ b/data/etc/platform.xml
@@ -62,6 +62,8 @@
 
     <permission name="android.permission.MANAGE_EXTERNAL_STORAGE" >
         <group gid="external_storage" />
+        <group gid="media_rw" />
+        <group gid="sdcard_rw" />
     </permission>
 
     <permission name="android.permission.ACCESS_MTP" >
@@ -132,7 +134,10 @@
          the fragility as one can remove a built-in permission which
          no longer needs to be mapped to gids and break grant propagation. -->
     <permission name="android.permission.READ_EXTERNAL_STORAGE" />
-    <permission name="android.permission.WRITE_EXTERNAL_STORAGE" />
+    <permission name="android.permission.WRITE_EXTERNAL_STORAGE">
+        <group gid="media_rw" />
+        <group gid="sdcard_rw" />
+    </permission>
 
     <!-- ================================================================== -->
     <!-- ================================================================== -->
-- 
2.30.2

